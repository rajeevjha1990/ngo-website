import{a as ut}from"./chunk-IQOOCDTI.js";import{a as ht}from"./chunk-BG456VJA.js";import{$,A as S,C as J,D as W,Da as mt,E as X,Ea as x,Fa as dt,K as q,L as G,O as L,P as M,Q as K,Y as Q,Z as Y,_ as Z,a as g,aa as tt,ba as P,d as p,f as U,g as R,ga as et,ia as it,ja as rt,ka as at,l as _,la as ot,m as k,n as B,oa as nt,p as H,q as F,qa as st,r as n,ra as lt,s as l,sa as ct,t as C,u as V,v as z,w as E,xa as pt,y as m}from"./chunk-NRP5MRDS.js";import"./chunk-DTATBPVL.js";import"./chunk-QUJFQN2Y.js";import"./chunk-X224L3SO.js";import"./chunk-C32O5GX5.js";import"./chunk-52TO42VW.js";import"./chunk-SEUP4ZMM.js";import"./chunk-DRMA3MWZ.js";import"./chunk-RUKPWWTB.js";import"./chunk-4KS6YN45.js";import"./chunk-QNCTVU3D.js";import"./chunk-ZIZQO6BN.js";import"./chunk-YXDY66DN.js";import"./chunk-64IMJK5F.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-WCS4JO7P.js";import"./chunk-CKP3SGE2.js";import"./chunk-GIMRDFJ3.js";import"./chunk-CI7KQTBV.js";import"./chunk-ELFU6LLF.js";import"./chunk-WO4BVH6B.js";import"./chunk-BUMCRR6Y.js";import"./chunk-DNTR6X5U.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-4YRHGV2P.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{a as N,b as T,h as r}from"./chunk-B7O3QC5Z.js";var yt="http://localhost/SVJ-API/public/",ft="https://sabkavikasjayti.org/API/public/",gt="api/",At="publicApi/";var _t=(()=>{let i=class i{constructor(t){this.storage=t,this._storage=null,this.formData=null,this.init()}init(){return r(this,null,function*(){this._storage=yield this.storage.create()})}set(t,e){return r(this,null,function*(){yield this._storage?.set(t,e)})}get(t){return r(this,null,function*(){let e=5;for(;!this._storage&&e>0;)e--,yield this.delay(500);return yield this._storage?.get(t)})}clear(){return r(this,null,function*(){yield this._storage?.clear()})}remove(t){return r(this,null,function*(){yield this._storage?.remove(t)})}delay(t){return new Promise(e=>setTimeout(e,t))}setFormData(t){return r(this,null,function*(){yield this._storage?.set("formData",t)})}getFormData(){return r(this,null,function*(){return yield this._storage?.get("formData")})}clearFormData(){return r(this,null,function*(){yield this._storage?.remove("formData")})}};i.\u0275fac=function(e){return new(e||i)(p(ht))},i.\u0275prov=g({token:i,factory:i.\u0275fac,providedIn:"root"});let a=i;return a})();var It=(()=>{let i=class i{constructor(t){this.storageServ=t,this.authkey="",this.getAuthkey()}setAuthkey(t){return r(this,null,function*(){this.authkey=t,yield this.storageServ.set("Authkey",t)})}getAuthkey(){return r(this,null,function*(){return this.authkey||(this.authkey=yield this.storageServ.get("Authkey")),this.authkey})}clear(){return r(this,null,function*(){yield this.storageServ.clear(),this.authkey=""})}};i.\u0275fac=function(e){return new(e||i)(p(_t))},i.\u0275prov=g({token:i,factory:i.\u0275fac,providedIn:"root"});let a=i;return a})();var vt=(()=>{let i=class i{constructor(t,e,o,u,f,d){this.plt=t,this.http=e,this.alertCtrl=o,this.loadingCtrl=u,this.navCtrl=f,this.authServ=d,this.BASE_URL="",this.BASE_API_URL="",this.UPLOADS="",this.authkey="",this.i=0,this.loadingElements=[],window.location.href.indexOf("localhost")<0||this.plt.is("android")||this.plt.is("ios")?this.BASE_URL=ft:this.BASE_URL=yt,this.BASE_API_URL=this.BASE_URL+gt,this.UPLOADS=this.BASE_URL}init(){return r(this,null,function*(){this.authkey=yield this.authServ.getAuthkey()})}post(d,Ct){return r(this,arguments,function*(t,e,o={},u=!0,f="urlencoded"){this.i++;let I=this.i;u&&(yield this.presentLoading(I)),t=this.BASE_API_URL+t;let h="",A;switch(f){case"urlencoded":h="application/x-www-form-urlencoded",A=new M({fromObject:e});break;case"multipart":h="";let s=new FormData;Object.entries(e).forEach(([c,w])=>s.append(c,w)),A=s;break;case"json":h="application/json",A=JSON.stringify(e);break}this.authkey||(yield this.init());let O=localStorage.getItem("auth_token")||"",D=new L({Source:"app",Authorization:`Bearer ${O}`,VeronAuthkey:this.authkey||""});h&&(D=D.set("Content-Type",h));let St={headers:D,observe:"response"},v={};try{let s=yield this.http.post(t,A,St).toPromise();if(s.status===200){let c=s.body;c.status=200,u&&c.msg&&this.presentAlert("",c.msg,"Success"),c.VeronAuthkey&&(this.authServ.setAuthkey(c.VeronAuthkey),this.authkey=c.VeronAuthkey),v=c}else this.presentAlert("Code: "+s.status,"Unexpected status code"),v=s.body||{},v.status=s.status}catch(s){let c=s.status;console.log(c);let w="Unidentified error, contact to admin.";try{w=s.error?.err||s.error?.msg||w}catch{}switch(typeof w=="object"&&(w=Object.values(w).join(`
`)),c){case 500:this.presentAlert("Server Error");break;case 404:this.presentAlert("API Not Found");break;case 401:this.presentAlert("Authorization Error","Mobile number not registered"),this.authServ.clear(),this.navCtrl.navigateRoot("/");break;default:let b="Unidentified error,contact  to admin.";try{b=s.error?.err||s.error?.msg||b}catch{}typeof b=="object"&&(b=Object.values(b).join(`
`)),this.presentAlert(b);break}v=s.error||{},v.status=c}return u&&this.loadingElements[I]&&this.loadingElements[I].dismiss(),v})}presentLoading(t){return r(this,null,function*(){this.loadingElements[t]=yield this.loadingCtrl.create({message:"Please wait...",spinner:"crescent"}),yield this.loadingElements[t].present()})}presentAlert(){return r(this,arguments,function*(t="",e="",o,u=["Ok"]){if(!o){let d=(e||t).toLowerCase();d.includes("not available")?o="Coupon Unavailable":d.includes("authorization")?o="Authorization Error":d.includes("required")?o="Validation Error":d.includes("server")?o="Server Error":d.includes("not found")?o="Not Found":o="Alert"}let f=yield this.alertCtrl.create({header:o,subHeader:t,message:e,buttons:u});yield f.present(),o!=="Error"&&o!=="Alert"&&setTimeout(()=>f.dismiss(),2e3)})}downloadFile(o){return r(this,arguments,function*(t,e={}){if(!navigator.onLine){this.presentAlert("No Internet Connection","Please check your internet connection and try again.");return}let u=new L().set("VeronAuthkey",this.authkey),f=new M({fromObject:e});this.http.get(this.BASE_API_URL+t,{headers:u,params:f,responseType:"blob"}).subscribe(d=>{let Ct=d.type,I=[];I.push(d);let h=document.createElement("a");h.href=window.URL.createObjectURL(new Blob(I,{type:Ct}));let A=t.split("/"),O=A[A.length-1];h.setAttribute("download",O),h.setAttribute("target","_blank"),document.body.appendChild(h),h.click()})})}};i.\u0275fac=function(e){return new(e||i)(p(tt),p(K),p(x),p(dt),p(P),p(It))},i.\u0275prov=g({token:i,factory:i.\u0275fac,providedIn:"root"});let a=i;return a})();var bt=(()=>{let i=class i{constructor(t){this.svjHttp=t}applyProgram(t){return r(this,null,function*(){let e=At+"apply_program";return yield this.svjHttp.post(e,t)})}};i.\u0275fac=function(e){return new(e||i)(p(vt))},i.\u0275prov=g({token:i,factory:i.\u0275fac,providedIn:"root"});let a=i;return a})();function Ot(a,i){if(a&1){let y=V();n(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),m(3,"Confirm Your Order"),l()(),n(4,"ion-card-content")(5,"p")(6,"b"),m(7,"Name:"),l(),m(8),l(),n(9,"p")(10,"b"),m(11,"Mobile:"),l(),m(12),l(),n(13,"p")(14,"b"),m(15,"Address:"),l(),m(16),l(),n(17,"h2",2),m(18),l(),n(19,"ion-radio-group",3),X("ngModelChange",function(e){U(y);let o=E();return W(o.payment_mode,e)||(o.payment_mode=e),R(e)}),n(20,"ion-item"),C(21,"ion-radio",4),n(22,"ion-label"),m(23,"Cash on Delivery"),l()(),n(24,"ion-item"),C(25,"ion-radio",5),n(26,"ion-label"),m(27,"UPI / QR"),l()(),n(28,"ion-item"),C(29,"ion-radio",6),n(30,"ion-label"),m(31,"Debit / Credit Card"),l()()(),n(32,"ion-button",7),z("click",function(){U(y);let e=E();return R(e.confirmOrder())}),m(33," Confirm & Place Order "),l()()()}if(a&2){let y=E();_(8),S(" ",y.applyData.name),_(4),S(" ",y.applyData.mobile),_(4),S(" ",y.applyData.address),_(2),S("Amount: \u20B9",y.MIN_AMOUNT),_(),J("ngModel",y.payment_mode)}}var Wt=(()=>{let i=class i{constructor(t,e,o){this.alertCtrl=t,this.navCtrl=e,this.programServ=o,this.MIN_AMOUNT=300,this.applyData=null,this.payment_mode="COD"}ngOnInit(){let t=localStorage.getItem("program_apply_data");if(!t){this.navCtrl.navigateBack("/program");return}this.applyData=JSON.parse(t),console.log(this.applyData)}confirmOrder(){return r(this,null,function*(){if(!this.payment_mode){yield this.showAlert("Please select payment method.");return}let t=T(N({},this.applyData),{amount:this.MIN_AMOUNT,payment_mode:this.payment_mode,payment_status:this.payment_mode==="COD"?"pending":"paid",transaction_id:""});console.log(t);try{let e=yield this.programServ.applyProgram(t);console.log(e),e&&e.status===200?(localStorage.removeItem("program_apply_data"),yield this.showAlert("\u0906\u092A\u0915\u093E \u0906\u0935\u0947\u0926\u0928 \u0938\u092B\u0932\u0924\u093E\u092A\u0942\u0930\u094D\u0935\u0915 \u0938\u092C\u092E\u093F\u091F \u0939\u094B \u0917\u092F\u093E \u0939\u0948 \u{1F64F}"),this.navCtrl.navigateRoot("/home")):yield this.showAlert(e?.msg||"Something went wrong.")}catch(e){console.error(e),yield this.showAlert("Server error.")}})}showAlert(t){return r(this,null,function*(){yield(yield this.alertCtrl.create({header:"Info",message:t,buttons:["OK"]})).present()})}};i.\u0275fac=function(e){return new(e||i)(k(x),k(P),k(bt))},i.\u0275cmp=B({type:i,selectors:[["app-program-payment"]],decls:4,vars:1,consts:[[1,"ion-padding"],[4,"ngIf"],[2,"color","green"],[3,"ngModelChange","ngModel"],["value","COD"],["value","UPI"],["value","ONLINE"],["expand","block","color","success",3,"click"]],template:function(e,o){e&1&&(n(0,"ion-header"),C(1,"app-header"),l(),n(2,"ion-content",0),H(3,Ot,34,5,"ion-card",1),l()),e&2&&(_(3),F("ngIf",o.applyData))},dependencies:[et,nt,st,lt,ct,it,at,rt,ot,G,q,$,Q,mt,pt,Z,Y,ut],encapsulation:2});let a=i;return a})();export{Wt as ProgramPaymentPage};
